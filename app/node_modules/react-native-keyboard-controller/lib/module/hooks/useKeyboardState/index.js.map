{"version":3,"names":["useEffect","useState","KeyboardEvents","KeyboardController","EVENTS","getLatestState","state","isVisible","defaultSelector","useKeyboardState","selector","setState","subscriptions","map","event","addListener","willShowSubscription","e","appearance","forEach","subscription","remove"],"sources":["index.ts"],"sourcesContent":["import { useEffect, useState } from \"react\";\n\nimport { KeyboardEvents } from \"../../bindings\";\nimport { KeyboardController } from \"../../module\";\n\nimport type { KeyboardState } from \"../../types\";\n\nconst EVENTS = [\"keyboardDidShow\", \"keyboardDidHide\"] as const;\n\nconst getLatestState = () => ({\n  ...KeyboardController.state(),\n  isVisible: KeyboardController.isVisible(),\n});\n\ntype KeyboardStateSelector<T> = (state: KeyboardState) => T;\n\nconst defaultSelector: KeyboardStateSelector<KeyboardState> = (state) => state;\n\n/**\n * React Hook that represents the current keyboard state on iOS and Android.\n * It tracks keyboard visibility, height, appearance, type and other properties.\n * This hook subscribes to keyboard events and updates the state reactively.\n *\n * @template T - A type of the returned object from the `selector`.\n * @param selector - A function that receives the current keyboard state and picks only necessary properties to avoid frequent re-renders.\n * @returns Object {@link KeyboardState|containing} keyboard state information.\n * @see {@link https://kirillzyusko.github.io/react-native-keyboard-controller/docs/api/hooks/keyboard/use-keyboard-state|Documentation} page for more details.\n * @example\n * ```tsx\n * function MyComponent() {\n *   const isVisible = useKeyboardState((state) => state.isVisible);\n *   const height = useKeyboardState((state) => state.height);\n *\n *   return (\n *     <View>\n *       <Text>Keyboard is {isVisible ? 'visible' : 'hidden'}</Text>\n *       <Text>Keyboard height: {height}</Text>\n *     </View>\n *   );\n * }\n * ```\n */\nfunction useKeyboardState<T = KeyboardState>(\n  selector: KeyboardStateSelector<T> = defaultSelector as KeyboardStateSelector<T>,\n): T {\n  const [state, setState] = useState<T>(() => selector(getLatestState()));\n\n  useEffect(() => {\n    const subscriptions = EVENTS.map((event) =>\n      KeyboardEvents.addListener(event, () =>\n        // state will be updated by global listener first,\n        // so we simply read it and don't derive data from the event\n        setState(selector(getLatestState())),\n      ),\n    );\n    // update `appearance` prematurely\n    const willShowSubscription = KeyboardEvents.addListener(\n      \"keyboardWillShow\",\n      (e) =>\n        setState(selector({ ...getLatestState(), appearance: e.appearance })),\n    );\n\n    // we might have missed an update between reading a value in render and\n    // `addListener` in this handler, so we set it here. If there was\n    // no change, React will filter out this update as a no-op.\n    setState(selector(getLatestState()));\n\n    return () => {\n      subscriptions.forEach((subscription) => subscription.remove());\n      willShowSubscription.remove();\n    };\n  }, []);\n\n  return state;\n}\n\nexport { useKeyboardState };\n"],"mappings":"AAAA,SAASA,SAAS,EAAEC,QAAQ,QAAQ,OAAO;AAE3C,SAASC,cAAc,QAAQ,gBAAgB;AAC/C,SAASC,kBAAkB,QAAQ,cAAc;AAIjD,MAAMC,MAAM,GAAG,CAAC,iBAAiB,EAAE,iBAAiB,CAAU;AAE9D,MAAMC,cAAc,GAAGA,CAAA,MAAO;EAC5B,GAAGF,kBAAkB,CAACG,KAAK,CAAC,CAAC;EAC7BC,SAAS,EAAEJ,kBAAkB,CAACI,SAAS,CAAC;AAC1C,CAAC,CAAC;AAIF,MAAMC,eAAqD,GAAIF,KAAK,IAAKA,KAAK;;AAE9E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAASG,gBAAgBA,CACvBC,QAAkC,GAAGF,eAA2C,EAC7E;EACH,MAAM,CAACF,KAAK,EAAEK,QAAQ,CAAC,GAAGV,QAAQ,CAAI,MAAMS,QAAQ,CAACL,cAAc,CAAC,CAAC,CAAC,CAAC;EAEvEL,SAAS,CAAC,MAAM;IACd,MAAMY,aAAa,GAAGR,MAAM,CAACS,GAAG,CAAEC,KAAK,IACrCZ,cAAc,CAACa,WAAW,CAACD,KAAK,EAAE;IAChC;IACA;IACAH,QAAQ,CAACD,QAAQ,CAACL,cAAc,CAAC,CAAC,CAAC,CACrC,CACF,CAAC;IACD;IACA,MAAMW,oBAAoB,GAAGd,cAAc,CAACa,WAAW,CACrD,kBAAkB,EACjBE,CAAC,IACAN,QAAQ,CAACD,QAAQ,CAAC;MAAE,GAAGL,cAAc,CAAC,CAAC;MAAEa,UAAU,EAAED,CAAC,CAACC;IAAW,CAAC,CAAC,CACxE,CAAC;;IAED;IACA;IACA;IACAP,QAAQ,CAACD,QAAQ,CAACL,cAAc,CAAC,CAAC,CAAC,CAAC;IAEpC,OAAO,MAAM;MACXO,aAAa,CAACO,OAAO,CAAEC,YAAY,IAAKA,YAAY,CAACC,MAAM,CAAC,CAAC,CAAC;MAC9DL,oBAAoB,CAACK,MAAM,CAAC,CAAC;IAC/B,CAAC;EACH,CAAC,EAAE,EAAE,CAAC;EAEN,OAAOf,KAAK;AACd;AAEA,SAASG,gBAAgB","ignoreList":[]}